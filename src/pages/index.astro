---
import { getTopTracks } from '../scripts/getTopTracks.js'
import Layout from '../layouts/Layout.astro'
import Marquee from '../components/Marquee.astro'
import ContactForm from '../components/ContactForm.astro'
import latestRenderImage from '../images/renders/braunHF3.jpg'
import latestRenderImageClay from '../images/renders/braunHF3-clay.jpg'
import profileImage from '../images/profile.png'
import eyeImage from '../images/eye.png'
import sunglassesImage from '../images/sunglasses.png'
import instagramLogo from '../images/icons/instagram.svg'
import spotifyLogo from '../images/icons/spotify.svg'
import linkedinLogo from '../images/icons/linkedin.svg'
import githubLogo from '../images/icons/github.svg'
import { Image } from 'astro:assets'
import { getResolvedPosts } from '../scripts/getResolvedPosts'

const refreshToken = import.meta.env.SPOTIFY_REFRESH_TOKEN

let topTracks = []
try {
	topTracks = await getTopTracks(refreshToken)
} catch (error) {
	console.error('Error fetching top tracks:', error)
}

const allPosts = await getResolvedPosts()

const latestPost = allPosts[0]
---

<Layout title="AndrÃ©'s Portfolio" description="Welcome to AndrÃ©'s Portfolio">
	<!-- Intro Section -->
	<div
		class="border-gradient relative flex flex-col items-center rounded-md bg-white px-4 py-8 shadow-lg sm:flex-row sm:rounded-lg sm:px-12 sm:py-24 xl:col-span-3 2xl:col-span-9"
	>
		<div class="z-10 flex-1">
			<div
				class="mb-8 hidden w-auto rounded-full border-2 border-gray-200 bg-gray-100 px-3 py-1 lg:inline-block"
			>
				<span class="text-base text-gray-400">ðŸ‘‹ vollrath.dev</span>
			</div>
			<h1
				class="long-transition text-gradient text-center font-header text-5xl sm:text-6xl md:mr-4 lg:text-left lg:text-8xl"
			>
				Hi, Iâ€™m AndrÃ©.
			</h1>
			<p
				class="z-10 my-4 max-w-screen-md rounded-xl bg-white/75 py-2 pr-2 text-base backdrop-blur-sm backdrop-brightness-125 max-2xl:max-w-full sm:my-6 sm:text-left sm:text-2xl/relaxed 3xl:max-w-screen-lg 3xl:text-3xl/relaxed"
			>
				With a <strong class="font-semibold">strong foundation</strong> in
				<strong class="font-semibold">design</strong> and
				<strong class="font-semibold">front-end development</strong>, I specialize in crafting <strong
					class="font-semibold">modern</strong
				>,
				<strong class="font-semibold">user-centric solutions</strong>. My work combines <strong
					class="font-semibold">creativity</strong
				>,
				<strong class="font-semibold">technology</strong>, and a
				<strong class="font-semibold">global perspective</strong> to help teams innovate and bring their
				ideas to life through
				<strong class="font-semibold">engaging digital experiences</strong>.
			</p>
			<div class="flex justify-center">
				<a
					href="#contact"
					class="shimmer flex items-center rounded-full bg-orange px-10 py-4 text-center font-semibold text-white transition duration-300 ease-[cubic-bezier(0.31,-0.105,0.43,2.4)] hover:scale-105 sm:text-3xl/relaxed"
					>Get in touch
					<svg
						xmlns="http://www.w3.org/2000/svg"
						class="float ml-2 h-6 w-6 stroke-white"
						fill="none"
						viewBox="0 0 24 24"
					>
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="3"
							d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
					</svg>
				</a>
			</div>
		</div>
		<div class="avatar-wrapper max-lg:hidden" id="face">
			<Image
				src={profileImage}
				alt="AndrÃ©'s Avatar"
				class="avatar-image"
				decoding="async"
				loading="lazy"
			/>
			<div class="eye-container">
				<Image src={eyeImage} alt="Left Eye" class="eye-left" decoding="async" loading="lazy" />
				<Image src={eyeImage} alt="Right Eye" class="eye-right" decoding="async" loading="lazy" />
				<Image
					src={sunglassesImage}
					alt="sunglasses"
					class="sunglasses"
					decoding="async"
					loading="lazy"
				/>
			</div>
		</div>
	</div>

	<!-- Now Section -->
	<div
		class="border-gradient clickable-section flex h-full flex-col justify-between rounded-md bg-white px-4 py-8 text-base shadow-lg sm:rounded-lg sm:p-12 sm:px-12 xl:col-span-1 xl:row-start-2 2xl:col-span-3 2xl:col-start-10 2xl:row-start-1"
	>
		<div class="mb-6 flex items-center justify-between">
			<span class="arrow invisible"> </span>
			<h2
				class="long-transition font-header text-xl tracking-wide sm:text-4xl"
				transition:name="now-header"
			>
				Now
			</h2>
			<a href="/now" class="arrow-link">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					class="h-6 w-6 stroke-dark-text"
					fill="none"
					viewBox="0 0 24 24"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
				</svg>
			</a>
		</div>
		<ul
			class="bullets long-transition sm:text-md mb-4 list-disc pl-5 text-base text-gray-400 3xl:text-lg"
		>
			<li class="sm:text-md mb-4 text-base 3xl:text-lg">
				Switched my Photography gear to an <strong class="font-semibold text-dark-text"
					>Olympus Micro Four Thirds system</strong
				>
			</li>
			<li class="sm:text-md mb-4 text-base 3xl:text-lg">
				Reading "<strong class="font-semibold text-dark-text">Feel-Good Productivity</strong>" <br
				/>
				by Ali Abdaal
			</li>
			<li class="sm:text-md mb-4 text-base 3xl:text-lg">
				Reading "<strong class="font-semibold text-dark-text">11/22/63</strong>" <br />
				by Stephen King
			</li>
			<li class="sm:text-md mb-4 text-base 3xl:text-lg">
				Reading "<strong class="font-semibold text-dark-text">Gut</strong>" <br />
				by Giulia Enders
			</li>
			<li class="sm:text-md mb-4 text-base 3xl:text-lg">
				Reading "<strong class="font-semibold text-dark-text">Don't Trust Your Gut</strong>" <br />
				by Seth Stephens-Davidowitz
			</li>
		</ul>

		<p class="text-center text-xs text-gray-400 sm:text-sm">Last Updated: January 6, 2025</p>
	</div>

	<!-- Latest Blog Section -->
	<div
		class="border-gradient clickable-section group h-full rounded-md bg-white px-4 py-8 shadow-lg sm:rounded-lg sm:p-12 xl:col-span-2 xl:col-start-2 xl:row-span-2 2xl:col-span-3 2xl:row-start-2"
	>
		<div class="mb-6 flex items-center justify-between">
			<span class="arrow invisible"> </span>
			<h2 class="long-transition text-center font-header text-xl tracking-wide sm:text-4xl">
				Blog
			</h2>
			<a href={latestPost.url} class="arrow-link">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					class="h-6 w-6 stroke-dark-text"
					fill="none"
					viewBox="0 0 24 24"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
				</svg>
			</a>
		</div>

		<div>
			<h3
				class="long-transition sm:text-md mb-6 text-center font-body text-base font-semibold text-orange 3xl:text-lg"
			>
				{latestPost.frontmatter.title}
			</h3>
			<div class="mb-6 w-full overflow-hidden rounded-md">
				<Image
					src={latestPost.frontmatter.image.src}
					alt={latestPost.frontmatter.image.alt}
					class="aspect-video w-full transform object-cover transition duration-1000 group-hover:scale-125"
					decoding="async"
					loading="lazy"
				/>
			</div>
			<p
				class="long-transition sm:text-md text-base text-gray-400 3xl:text-lg"
				set:html={latestPost.frontmatter.teaser}
			/>
			<div class="flex justify-center">
				<button
					class="mt-12 rounded-full bg-orange px-10 py-4 text-lg font-semibold text-white transition-transform hover:scale-105"
					>Read blog post</button
				>
			</div>
		</div>
	</div>

	<!-- About Section -->
	<div
		class="clickable-section bright-section h-full rounded-md bg-about-gradient px-4 py-8 text-base text-white shadow-lg sm:rounded-lg sm:p-12 xl:col-span-1 xl:row-start-3 2xl:col-span-3 2xl:col-start-4 2xl:row-start-2"
	>
		<div class="mb-6 flex items-center justify-between">
			<span class="arrow invisible"> </span>
			<h2
				class="long-transition font-header text-xl tracking-wide sm:text-4xl"
				transition:name="about-header"
			>
				About
			</h2>
			<a href="/about" class="arrow-link white">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					class="h-6 w-6 stroke-white"
					fill="none"
					viewBox="0 0 24 24"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
				</svg>
			</a>
		</div>
		<p class="sm:text-md text-base 3xl:text-lg">
			Hi there! I'm <strong class="font-semibold">AndrÃ© Vollrath</strong>â€”a dedicated designer and
			front-end developer eager to connect and collaborate. I thrive on transforming creative ideas
			into impactful digital experiences. With more than ten years of hands-on experience, I blend
			creative vision with technical expertise to craft engaging websites, dynamic web applications,
			and beyond.
		</p>
		<br />
		<p class="sm:text-md text-base 3xl:text-lg">
			My passion for <strong class="font-semibold">design</strong> drives me to continuously explore
			and innovate. Whether creating compelling visual content or crafting intuitive user interfaces,
			I push creative boundaries to deliver visually stunning and user-friendly solutions. I'm excited
			to bring my enthusiasm, attention to detail, and collaborative approach to new challenges and opportunities.
		</p>
	</div>

	<!-- Latest Render Section -->
	<div
		class="border-gradient clickable-section latest-render-section h-full rounded-md bg-white from-dark-card to-darker-card px-4 py-8 shadow-lg dark:bg-gradient-to-r sm:rounded-lg sm:p-12 xl:col-span-3 xl:row-start-4 2xl:col-span-6 2xl:col-start-7 2xl:row-start-2"
	>
		<div class="mb-6 flex items-center justify-between">
			<span class="arrow invisible"> </span>
			<h2
				class="long-transition text-center font-header text-xl tracking-wide sm:text-left sm:text-4xl"
			>
				Latest Render
			</h2>
			<a href="/renders" class="arrow-link">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					class="h-6 w-6 stroke-dark-text"
					fill="none"
					viewBox="0 0 24 24"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="3"
						d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
				</svg>
			</a>
		</div>
		<div class="image-container rounded-md">
			<Image
				src={latestRenderImage}
				alt="Latest Render"
				transition:name="latest-render"
				class="rounded-md"
				densities={[1, 1.5, 2]}
				decoding="async"
				loading="lazy"
			/>
			<Image src={latestRenderImageClay} alt="Wireframe Render" class="wireframe-image" />
		</div>
	</div>

	<!-- Spotify Section -->
	<div
		class="border-gradient flex h-full flex-col items-center overflow-visible rounded-md bg-white from-dark-card to-darker-card px-4 py-8 shadow-lg dark:bg-gradient-to-r sm:rounded-lg xl:col-span-2 xl:row-start-5 2xl:col-span-9 2xl:row-start-3"
	>
		<h2 class="long-transition mb-8 text-center font-header text-xl tracking-wide sm:text-4xl">
			Spotify Top 10 <span
				class="whitespace-nowrap text-base font-semibold tracking-normal text-gray-400 sm:text-2xl"
				>(last 6 months)</span
			>
		</h2>
		<div class="flex w-full flex-row flex-wrap justify-center gap-2">
			{
				topTracks.map((track) =>
					track && track.external_urls && track.album && track.album.images[0] ? (
						<div key={track.id}>
							<a
								href={track.external_urls.spotify}
								target="_blank"
								title={`<strong class="font-semibold">${track.name}</strong> - ${track.artists.map((artist) => artist.name).join(', ')}`}
							>
								<img
									src={track.album.images[0].url}
									alt={`Cover art for ${track.name}`}
									class="h-auto w-24 rounded-md shadow-lg transition-transform duration-300 hover:scale-105 3xl:w-32"
								/>
							</a>
						</div>
					) : null
				)
			}
		</div>
	</div>

	<!-- Tech stack -->
	<div
		class="border-gradient h-full rounded-md bg-white from-dark-card to-darker-card pb-8 shadow-lg dark:bg-gradient-to-r sm:rounded-lg xl:col-span-3 xl:row-start-7 2xl:col-span-9 2xl:row-start-4"
	>
		<h2
			class="long-transition p-6 text-center font-header text-xl tracking-wide sm:p-12 sm:text-4xl"
		>
			Tech stack
		</h2>
		<Marquee
			words={[
				'React',
				'HTML5',
				'Tailwind',
				'Astro.js',
				'GSAP',
				'Three.js',
				'CSS3',
				'SASS',
				'LESS',
				'Git',
				'Webpack',
				'Vite',
				'Node.js',
				'ES6/ESNext'
			]}
		/>
	</div>

	<!-- Links Section -->
	<div
		class="border-gradient flex h-full flex-col rounded-md bg-white from-dark-card to-darker-card px-4 py-8 shadow-lg dark:bg-gradient-to-r sm:rounded-lg sm:p-12 xl:col-span-1 xl:col-start-3 xl:row-start-5 2xl:col-span-3 2xl:row-start-4"
	>
		<h2 class="long-transition mb-4 text-center font-header text-xl tracking-wide sm:text-4xl">
			Links
		</h2>
		<div class="flex flex-1 items-center justify-center">
			<div class="grid grid-cols-2 gap-2">
				<a href="https://github.com/avollrath" target="_blank" title="GitHub">
					<Image
						src={githubLogo}
						alt="Github Logo"
						class="h-auto w-24 rounded-md transition-transform duration-300 hover:scale-105 3xl:w-32"
						decoding="async"
						loading="lazy"
					/>
				</a>
				<a href="https://www.instagram.com/charliefeatherlight/" target="_blank" title="Instagram">
					<Image
						src={instagramLogo}
						alt="Instagram Logo"
						class="h-auto w-24 rounded-md transition-transform duration-300 hover:scale-105 3xl:w-32"
						decoding="async"
						loading="lazy"
					/>
				</a>
				<a href="https://www.linkedin.com/in/andrevollrath/" target="_blank" title="LinkedIn">
					<Image
						src={linkedinLogo}
						alt="LinkedIn Logo"
						class="h-auto w-24 rounded-md transition-transform duration-300 hover:scale-105 3xl:w-32"
						decoding="async"
						loading="lazy"
					/>
				</a>
				<a
					href="https://open.spotify.com/playlist/37i9dQZF1Fa1IIVtEpGUcU?si=0d61932237bf4497"
					target="_blank"
					title="Spotify"
				>
					<Image
						src={spotifyLogo}
						alt="Spotify Logo"
						class="h-auto w-24 rounded-md transition-transform duration-300 hover:scale-105 3xl:w-32"
						decoding="async"
						loading="lazy"
					/>
				</a>
			</div>
		</div>
	</div>

	<!-- Contact Section -->
	<div
		class="border-gradient flex h-full flex-col justify-center rounded-md bg-white px-4 py-8 shadow-lg dark:bg-gradient-to-r sm:rounded-lg sm:p-12 xl:col-span-1 xl:col-start-3 xl:row-start-6 2xl:col-span-4 2xl:col-start-1 2xl:row-start-5"
	>
		<h2 class="long-transition mb-6 text-center font-header text-xl tracking-wide sm:text-4xl">
			Get in touch
		</h2>
		<div id="contact" class="flex flex-1 items-center justify-center">
			<ContactForm />
		</div>
	</div>

	<!-- Based in Section -->
	<div
		class="border-gradient flex h-full flex-col rounded-md bg-white px-4 py-8 shadow-lg dark:bg-gradient-to-r sm:rounded-lg sm:p-12 xl:col-span-2 xl:col-start-1 xl:row-start-6 2xl:col-span-8 2xl:row-start-5"
	>
		<h2 class="long-transition mb-12 text-center font-header text-xl sm:text-4xl">Based in</h2>
		<div class="flex flex-col items-center justify-center xl:flex-row 2xl:flex-row">
			<!-- <img
				src={`basedin.svg`}
				alt="Globe"
				class="mb-12 mr-0 h-auto w-72 invert-[.5] md:py-12 xl:mr-12 2xl:w-96"
			/> -->
			<div class="mb-12 mr-0 h-auto w-72 opacity-60 xl:mb-0 xl:mr-12 2xl:w-96">
				<script src="https://unpkg.com/@lottiefiles/lottie-player@2.0.8/dist/lottie-player.js"
				></script><lottie-player
					src="https://lottie.host/e08917be-738c-4d39-b834-a4302a5a93c0/5zKSJTrRJ7.json"
					background="##FFFFFF"
					speed="1"
					style="width: 100%; height: 100%"
					loop
					autoplay
					direction="1"
					mode="normal"></lottie-player>
			</div>
			<div class="grid grid-flow-row gap-2">
				<h1 class="text-center font-header text-5xl sm:text-8xl lg:text-left 2xl:text-9xl">
					Helsinki<br />Finland<br /><span class="text-gray-400">GMT +2</span>
				</h1>
			</div>
		</div>
	</div>
</Layout>

<script is:inline>
	function initEyes() {
		const eyes = document.querySelectorAll('.eye-left, .eye-right')
		const sunglasses = document.querySelector('.sunglasses')
		const contactButton = document.querySelector('a[href="#contact"]')
		const MAX_DISTANCE = 10
		const padding = 10

		let isEyeHovered = false
		let isButtonHovered = false
		let removalTimeout = null

		function updateSunglassesVisibility() {
			if (!sunglasses) return

			if (isEyeHovered || isButtonHovered) {
				if (removalTimeout) {
					clearTimeout(removalTimeout)
					removalTimeout = null
				}
				sunglasses.classList.add('visible')
			} else {
				if (!removalTimeout) {
					removalTimeout = setTimeout(() => {
						sunglasses.classList.remove('visible')
						removalTimeout = null
					}, 300)
				}
			}
		}

		document.addEventListener('mousemove', (e) => {
			eyes.forEach((eye) => {
				const rect = eye.getBoundingClientRect()
				const centerX = rect.left + rect.width / 2
				const centerY = rect.top + rect.height / 2
				const dx = e.clientX - centerX
				const dy = e.clientY - centerY
				const angle = Math.atan2(dy, dx)
				const distance = Math.hypot(dx, dy)
				const clampedDistance = Math.min(distance, MAX_DISTANCE)
				const offsetX = clampedDistance * Math.cos(angle)
				const offsetY = clampedDistance * Math.sin(angle)
				eye.style.transform = `translate(${offsetX}px, ${offsetY}px)`
			})

			let overEye = false
			eyes.forEach((eye) => {
				const rect = eye.getBoundingClientRect()
				const paddedLeft = rect.left - padding
				const paddedRight = rect.right + padding
				const paddedTop = rect.top - padding
				const paddedBottom = rect.bottom + padding
				if (
					e.clientX >= paddedLeft &&
					e.clientX <= paddedRight &&
					e.clientY >= paddedTop &&
					e.clientY <= paddedBottom
				) {
					overEye = true
				}
			})

			isEyeHovered = overEye
			updateSunglassesVisibility()
		})

		if (contactButton) {
			contactButton.addEventListener('mouseenter', () => {
				isButtonHovered = true
				updateSunglassesVisibility()
			})
			contactButton.addEventListener('mouseleave', () => {
				isButtonHovered = false
				updateSunglassesVisibility()
			})
		}

		document.addEventListener('astro:after-swap', initEyes)
	}

	initEyes()
</script>

<style>
	.render-container {
		position: relative;
	}

	.image-container {
		position: relative;
	}

	.render-image,
	.wireframe-image {
		max-width: 100%;
		transition: 0.5s ease-in-out;
	}

	.wireframe-image {
		position: absolute;
		top: 0;
		left: 0;
		opacity: 0;
	}

	.image-container:hover .wireframe-image {
		opacity: 1;
		transform: scale(1.1);
	}

	@keyframes fadeInOut {
		0%,
		50% {
			opacity: 0;
		}
		25%,
		75% {
			opacity: 1;
		}
	}

	@media (hover: none) {
		.wireframe-image {
			animation: fadeInOut 10s infinite ease-in-out;
		}
	}
</style>
